var v=(t,e,n)=>new Promise((s,u)=>{var l=a=>{try{r(n.next(a))}catch(c){u(c)}},o=a=>{try{r(n.throw(a))}catch(c){u(c)}},r=a=>a.done?s(a.value):Promise.resolve(a.value).then(l,o);r((n=n.apply(t,e)).next())});import{aA as I,d as h,f as z,_ as C,u as F,av as S}from "./index.js";import{g as A,r as k,a5 as T,s as g,e as _,q as N,J as R,u as d,k as f,d as y,a7 as p,_ as w,a8 as $,a9 as m,E as j,a1 as D,ac as B,ad as E,aa as O,R as P,ai as q,aj as V,f as J}from "./vue-50936e44.js";import{C as L,a1 as U}from "./antd-685f22a1.js";function G(t, e="value", n="change", s){const u=A(),l=u==null?void 0:u.emit,o=k({value:t[e]}),r=T(o),a= i=>{o.value=i};return g(()=>{o.value=t[e]}),[_({get(){return o.value},set(i){L(i,r.value)||(o.value=i,N(()=>{l==null||l(n,i,...R(d(s))||[])}))}}),a,r]}function H(t){const e=f(t),n=f(!1);let s;function u(){s&&window.clearInterval(s)}function l(){n.value=!1,u(),s=null}function o(){d(n)||s||(n.value=!0,s=setInterval(()=>{d(e)===1?(l(),e.value=t):e.value-=1},1e3))}function r(){e.value=t,l()}function a(){r(),o()}return I(()=>{r()}),{start:o,reset:r,restart:a,clear:u,stop:l,currentCount:e,isStart:n}}const K={value:{type:[Object,Number,String,Array]},count:{type:Number,default:60},beforeStartFunc:{type:Function,default:null}},M=y({name:"CountButton",components:{Button:U},props:K,setup(t){const e=f(!1),{currentCount:n,isStart:s,start:u,reset:l}=H(t.count),{t:o}=h(),r=_(()=>d(s)?o("component.countdown.sendText",[d(n)]):o("component.countdown.normalText"));g(()=>{t.value===void 0&&l()});function a(){return v(this,null,function*(){const{beforeStartFunc:c}=t;if(c&&z(c)){e.value=!0;try{(yield c())&&u()}finally{e.value=!1}}else u()})}return{handleStart:a,currentCount:n,loading:e,getButtonText:r,isStart:s}}});function Q(t, e, n, s, u, l){const o=p("Button");return w(),$(o,B(t.$attrs,{disabled:t.isStart,onClick:t.handleStart,loading:t.loading}),{default:m(()=>[j(D(t.getButtonText),1)]),_:1},16,["disabled","onClick","loading"])}const b=C(M,[["render",Q]]),W={value:{type:String},size:{type:String,validator: t=>["default","large","small"].includes(t)},count:{type:Number,default:60},sendCodeApi:{type:Function,default:null}},X=y({name:"CountDownInput",components:{CountButton:b},inheritAttrs:!1,props:W,setup(t){const{prefixCls:e}=F("countdown-input"),[n]=G(t);return{prefixCls:e,state:n}}});function Y(t, e, n, s, u, l){const o=p("CountButton"),r=p("a-input");return w(),$(r,B(t.$attrs,{class:t.prefixCls,size:t.size,value:t.state}),E({addonAfter:m(()=>[J(o,{size:t.size,count:t.count,value:t.state,beforeStartFunc:t.sendCodeApi},null,8,["size","count","value","beforeStartFunc"])]),_:2},[O(Object.keys(t.$slots).filter(a=>a!=="addonAfter"), a=>({name:a,fn:m(c=>[P(t.$slots,a,q(V(c||{})))])}))]),1040,["class","size","value"])}const Z=C(X,[["render",Y]]),at=S(Z);S(b);export{at as C,G as u};
